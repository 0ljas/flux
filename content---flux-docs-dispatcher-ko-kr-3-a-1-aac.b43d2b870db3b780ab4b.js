(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{41:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",function(){return c}),n.d(t,"rightToc",function(){return p}),n.d(t,"default",function(){return b});n(0);var a=n(61);function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c={id:"dispatcher-ko-KR",title:"Dispatcher"},p=[{value:"API",id:"api",children:[]},{value:"예시",id:"예시",children:[]}],o={rightToc:p},l="wrapper";function b(e){var t=e.components,n=i(e,["components"]);return Object(a.b)(l,r({},o,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Dispatcher는 등록된 callback에 데이터를 중계할 때 사용된다. 일반적인 pub-sub 시스템과는 다음 두 항목이 다르다:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"콜백은 이벤트를 개별적으로 구독하지 않는다. 모든 데이터 변동은 등록된 모든 콜백에 전달된다."),Object(a.b)("li",{parentName:"ul"},"콜백이 실행될 때 콜백의 전체나 일부를 중단할 수 있다.")),Object(a.b)("p",null,"소스 코드를 보려면 ",Object(a.b)("a",r({parentName:"p"},{href:"https://github.com/facebook/flux/blob/master/src/Dispatcher.js"}),"Dispatcher.js"),"에서 확인할 수 있다."),Object(a.b)("h2",null,Object(a.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"api"})),Object(a.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#api"}),"#"),"API"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("strong",{parentName:"p"},Object(a.b)("inlineCode",{parentName:"strong"},"register(function callback): string")),"\n모든 데이터 변동이 있을 때 실행될 콜백을 등록한다. ",Object(a.b)("inlineCode",{parentName:"p"},"waitFor()"),"에서 사용 가능한 토큰을 반환한다.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("strong",{parentName:"p"},Object(a.b)("inlineCode",{parentName:"strong"},"unregister(string id): void")),"\n토큰으로 콜백을 제거한다.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("strong",{parentName:"p"},Object(a.b)("inlineCode",{parentName:"strong"},"waitFor(array<string> ids): void")),"\n현재 실행한 콜백이 진행되기 전에 특정 콜백을 지연하게 한다. 데이터 변동에 응답하는 콜백에만 사용해야 한다.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("strong",{parentName:"p"},Object(a.b)("inlineCode",{parentName:"strong"},"dispatch(object payload): void"))," 등록된 모든 콜백에 데이터를 전달한다.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("strong",{parentName:"p"},Object(a.b)("inlineCode",{parentName:"strong"},"isDispatching(): boolean"))," 이 Dispatcher가 지금 데이터를 전달하고 있는지 확인한다."))),Object(a.b)("h2",null,Object(a.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"예시"})),Object(a.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#예시"}),"#"),"예시"),Object(a.b)("p",null,"가상의 비행 목적지 양식에서 국가를 선택했을 때 기본 도시를 선택하는 예를 보자:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-js"}),"var flightDispatcher = new Dispatcher();\n\n// 어떤 국가를 선택했는지 계속 추적한다\nvar CountryStore = {country: null};\n\n// 어느 도시를 선택했는지 계속 추적한다\nvar CityStore = {city: null};\n\n// 선택된 도시의 기본 항공료를 계속 추적한다\nvar FlightPriceStore = {price: null};\n")),Object(a.b)("p",null,"사용자가 선택한 도시를 변경하면 데이터를 전달한다:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-js"}),"flightDispatcher.dispatch({\n  actionType: 'city-update',\n  selectedCity: 'paris'\n});\n")),Object(a.b)("p",null,"이 데이터 변동은 ",Object(a.b)("inlineCode",{parentName:"p"},"CityStore"),"가 소화한다:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-js"}),"flightDispatcher.register(function(payload) {\n  if (payload.actionType === 'city-update') {\n    CityStore.city = payload.selectedCity;\n  }\n});\n")),Object(a.b)("p",null,"사용자가 국가를 선택하면 데이터를 전달한다:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-js"}),"flightDispatcher.dispatch({\n  actionType: 'country-update',\n  selectedCountry: 'australia'\n});\n")),Object(a.b)("p",null,"이 데이터는 두 store에 의해 소화된다:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-js"})," CountryStore.dispatchToken = flightDispatcher.register(function(payload) {\n  if (payload.actionType === 'country-update') {\n    CountryStore.country = payload.selectedCountry;\n  }\n});\n")),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"CountryStore"),"가 등록한 콜백을 업데이트 할 때 반환되는 토큰을 참조값으로 저장했다. 이 토큰은 ",Object(a.b)("inlineCode",{parentName:"p"},"waitFor()"),"\n에서 사용할 수 있고 ",Object(a.b)("inlineCode",{parentName:"p"},"CityStore"),"가 갱신하는 것보다 먼저 ",Object(a.b)("inlineCode",{parentName:"p"},"CountryStore"),"를 갱신하도록 보장할 수 있다."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-js"}),"CityStore.dispatchToken = flightDispatcher.register(function(payload) {\n  if (payload.actionType === 'country-update') {\n    // `CountryStore.country`는 업데이트 되지 않는다\n    flightDispatcher.waitFor([CountryStore.dispatchToken]);\n    // `CountryStore.country`는 업데이트가 될 수 있음이 보장되었다\n\n    // 새로운 국가의 기본 도시를 선택한다\n    CityStore.city = getDefaultCityForCountry(CountryStore.country);\n  }\n});\n")),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"waitFor()"),"는 다음과 같이 묶을 수 있다:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-js"}),"FlightPriceStore.dispatchToken =\n  flightDispatcher.register(function(payload) {\n    switch (payload.actionType) {\n      case 'country-update':\n      case 'city-update':\n        flightDispatcher.waitFor([CityStore.dispatchToken]);\n        FlightPriceStore.price =\n          getFlightPriceStore(CountryStore.country, CityStore.city);\n        break;\n  }\n});\n")),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"country-update"),"는 콜백이 등록된 순서 즉 ",Object(a.b)("inlineCode",{parentName:"p"},"CountryStore"),", ",Object(a.b)("inlineCode",{parentName:"p"},"CityStore"),", ",Object(a.b)("inlineCode",{parentName:"p"},"FlightPriceStore")," 순서로 실행되도록 보장된다."))}b.isMDXComponent=!0}}]);